В данной работе предлагается улучшение динамических архитектур для обучения с добавлением новых классов (class incremental learning),
основанное на анализе потока информации между последовательными стадиями обучения.

![TCIL architercture](https://raw.githubusercontent.com/YellowPancake/TCIL/main/pictures/TCIL.png)


Была модифицирована функция потерь в методе [TCIL](https://github.com/YellowPancake/TCIL), был введен регуляризатор, учитывающий специфические особенности обучения с добавлением новых классов.

$`L^{i}_{reg} = \sum_{F_i}\log\left(\sigma_{batch }\left(F_i\right ) \right )`$, $`F_i`$ - набор активаций i-го энкодера 

$`L = L_{TCIL} + w_{reg} * \left(-L^{n}_{reg} + \sum_{i=1..n-1} L^{i}_{reg}) \right )`$ , $`n`$ - номер текущей стадии обучения




Этот регуляризатор повышает энтропию для текущей задачи, одновременно уменьшая энтропию для предыдущих задач. Это способствует уменьшению эффекта катастрофического забывания и более точному различению между классами из разных шагов обучения.

Наш метод улучшает существующий state-of-the-art подход TCIL. В результате применения нашего подхода, экспериментально подтверждено улучшение точности на наборе данных CIFAR100.  В сравнении с текущими методами, наш подход демонстрирует превосходство в большинстве экспериментов, показывая улучшение как top-1, так и top-5 точности





## Результаты

### Total accuracy top1/top5


| pretrain <br/> classes | num finetune <br/> stages | OUR <br/>  $`w_{reg}=2\mathrm{e}{-5}`$ | TCIL            |
|------------------------|---------------------------|----------------------------------------|-----------------|
| 0                      | 5                         | **70.14**/91.77                        | 69.51/**92.17** |
| 0                      | 10                        | **67.3/90.24**                         | 65.79/89.99     |
| 0                      | 20                        | **63.26/87.6**                         | 62.47/86.95     |
|                        |                           |                                        |                 |
| 50                     | 2                         | **72.66/92.74**                        | 72.61/92.4      |
| 50                     | 5                         | **71.03/91.93**                        | 70.11/91.48     |
| 50                     | 10                        | **69.21/91.36**                        | 68.24/89.97     |


Для воспроизведения результатов:
```shell
sh scripts/run.sh
```